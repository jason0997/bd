<div class="game-container">
    <h1 class="text-3xl sm:text-4xl font-bold text-gray-800 mb-2 text-center">ä¸­æ–‡è®°å¿†é…å¯¹æ¸¸æˆ</h1>
    <p class="text-gray-600 text-center mb-4">ç‚¹å‡»å¡ç‰‡ï¼Œç¿»å¼€å­—ç¬¦ï¼Œæ‰¾åˆ°ç›¸åŒçš„ä¸¤å¼ å¡ç‰‡ï¼</p>

    <div id="game-grid" class="grid-container">
        </div>
    <button id="reset-button" class="button-primary">é‡æ–°å¼€å§‹1</button>

    <script>
        // Array of Chinese characters for the game. Each character will appear twice.
        const characters = ['ç¦', 'å¯¿', 'å®‰', 'åº·', 'ä¸‡', 'äº‹', 'å¦‚', 'æ„'];
        let gameCards = [];
        let flippedCards = [];
        let matchedPairs = 0;
        let lockBoard = false;
        let totalPairs = characters.length;
        const gameGrid = document.getElementById('game-grid');

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function initializeGame() {
            const duplicatedCharacters = [...characters, ...characters];
            const shuffledCharacters = shuffleArray(duplicatedCharacters);
            gameGrid.innerHTML = '';
            gameCards = [];
            flippedCards = [];
            matchedPairs = 0;
            lockBoard = false;
            
            shuffledCharacters.forEach((char, index) => {
                const card = document.createElement('div');
                card.classList.add('card');
                card.dataset.index = index;
                card.dataset.char = char;

                card.innerHTML = `
                    <div class="card-inner">
                        <div class="card-front">${char}</div>
                        <div class="card-back"></div>
                    </div>
                `;
                card.addEventListener('click', () => flipCard(card));
                gameGrid.appendChild(card);
                gameCards.push(card);
            });
        }

        function flipCard(card) {
            if (lockBoard || card.classList.contains('flipped') || card.classList.contains('matched')) {
                return;
            }
            card.classList.add('flipped');
            flippedCards.push(card);
            if (flippedCards.length === 2) {
                lockBoard = true;
                checkForMatch();
            }
        }

        function checkForMatch() {
            const [card1, card2] = flippedCards;
            const isMatch = card1.dataset.char === card2.dataset.char;
            if (isMatch) {
                card1.classList.add('matched');
                card2.classList.add('matched');
                matchedPairs++;
                resetFlippedCards();
                if (matchedPairs === totalPairs) {
                    setTimeout(() => {
                        const blessingMessage = 'ç¥å”å”ç”Ÿæ—¥å¿«ä¹ğŸ‚<br>èº«ä½“å¥åº·ğŸ’ª<br>ç¦å¯¿å®‰åº·ğŸŒ¿<br>ä¸‡äº‹å¦‚æ„ğŸ‰';
                        window.showVictoryModal(blessingMessage);
                    }, 500);
                }
            } else {
                setTimeout(() => {
                    card1.classList.remove('flipped');
                    card2.classList.remove('flipped');
                    resetFlippedCards();
                }, 1000);
            }
        }

        function resetFlippedCards() {
            flippedCards = [];
            lockBoard = false;
        }

        // Add event listener for the reset button
        document.getElementById('reset-button').addEventListener('click', initializeGame);

        // åˆå§‹åŒ–æ¸¸æˆ
        initializeGame();
    </script>
</div>
